<!--suppress ALL -->

<svg version="1.1" baseProfile="full"
     xmlns="http://www.w3.org/2000/svg"
     id="canvas" viewBox="0 0 800 600"
     stroke="black" stroke-width="0.5px"
     onmousemove="mouseMove(evt)"
     onmouseout="revert(evt)">

    <rect width="100%" fill="87cefa"></rect>
    <defs>
        <rect id="def-rect"
              x="-25" y="-25"
              width="50" height="50"
              fill="#29e">
        </rect>
    </defs>

    <!-- reference resourses by ID in xlink:href attribute -->
    <use xlink:href="#def-rect" transform="translate(100 50)">
        <!--<animate attributeName="transform" to="translate(300 150)" dur="500ms" repeatCount="indefinite"></animate>-->
        <animateTransform
                attributeName="transform" type="translate"
                values="0 0; 200 50; 0 0"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
        <animateTransform
                attributeName="transform" type="rotate"
                values="360 0 0; 0 0 360; 360 0 0"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
        <animateTransform
                attributeName="transform" type="scale"
                values="0.5; 1.5; 0.5"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>
    <use xlink:href="#def-rect" transform="translate(200 50)"/>
    <use xlink:href="#def-rect" transform="translate(300 50)"/>


    <symbol id="pointed-bezier-curve-item">
        <path d="M10 80 C 40 10, 65 10, 95 80 S 150 150, 180 80, 250 10, 275 80" stroke="black" fill="transparent"/>
        <circle cx="10" cy="80" r="2" fill="red"></circle>
        <circle cx="40" cy="10" r="2" fill="red"></circle>
        <circle cx="65" cy="10" r="2" fill="red"></circle>
        <circle cx="95" cy="80" r="2" fill="red"></circle>

        <circle cx="150" cy="150" r="2" fill="red"></circle>
        <circle cx="180" cy="80" r="2" fill="red"></circle>
        <circle cx="250" cy="10" r="2" fill="red"></circle>
        <circle cx="275" cy="80" r="2" fill="red"></circle>
    </symbol>

    <!--<symbol id="cloud-item">-->
        <!--<path d="M10 180 C 10 150, 35 110, 65 110,-->
                           <!--100 110, 130 70, 130 40" stroke="black" fill="transparent"/>-->
        <!--<circle cx="10" cy="180" r="2" fill="red"></circle>-->
        <!--<circle cx="10" cy="150" r="2" fill="red"></circle>-->
        <!--<circle cx="35" cy="110" r="2" fill="red"></circle>-->
        <!--<circle cx="65" cy="110" r="2" fill="red"></circle>-->

        <!--<circle cx="100" cy="110" r="2" fill="red"></circle>-->
        <!--<circle cx="130" cy="70" r="2" fill="red"></circle>-->
        <!--<circle cx="130" cy="40" r="2" fill="red"></circle>-->
    <!--</symbol>-->

    <symbol id="cloud-item">
        <path d="M10 150 C 30 110, 50 110, 70 150,
                           100 90, 130 90, 150 150
                           170 110, 190 110, 210 150

                           190 220, 170 220, 150 180
                           130 240, 100 240, 70 200
                           50 220, 30 220, 10 180" stroke="black" fill="transparent"/>


        <circle cx="10" cy="180" r="2" fill="red"></circle>
        <circle cx="10" cy="150" r="2" fill="red"></circle>
        <circle cx="35" cy="110" r="2" fill="red"></circle>
        <circle cx="65" cy="110" r="2" fill="red"></circle>

    </symbol>

    <use href="#pointed-bezier-curve-item" transform="translate(300 100)"></use>

    <use href="#cloud-item" transform="translate(100 0)"></use>






    <symbol id="mountain-item">
        <polygon id="mountain-poly" points="0,600 100,210 200,600" fill="gray" stroke="aqua" stroke-width="1" >
        </polygon>
    </symbol>


    <!----------------------SLOW MOUNTAINS--------------------->
    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="400 50; -400 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>
    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="500 50; -300 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>
    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="600 50; -200 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>

    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="1200 50; 400 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>
    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="1300 50; 500 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>
    <use id="mountain1" href="#mountain-item">
        <animateTransform
                attributeName="transform" type="translate"
                values="1400 50; 600 50"
                additive="sum"
                dur="3s"
                repeatCount="indefinite" />
    </use>









    <!----------------------FAST MOUNTAINS--------------------->
    <symbol id="fast-mountains-item" width="1600">
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="400 150; -600 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="500 150; -500 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="700 150; -300 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="800 150; -200 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>

        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="1400 150; 400 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="1500 150; 500 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="1700 150; 700 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
        <use id="mountain1" href="#mountain-item">
            <animateTransform
                    attributeName="transform" type="translate"
                    values="1800 150; 800 150"
                    additive="sum"
                    dur="3s"
                    repeatCount="indefinite" />
        </use>
    </symbol>

    <!--PART OF THE BACKGROUND-->
    <use href="#fast-mountains-item"/>

    <text id="posX" x="20" y="15" fill="red">X: -- px </text>
    <text id="posY" x="20" y="40" fill="red">Y: -- px </text>


    <image id="superman" href="superman.png" x="100" y="300" width="300" height="200" fill="black">
        <animate id="animate-up" attributeName="y" from="20" to="0"
                 begin="click" dur="500ms" repeatCount="1"></animate>
    </image>
    <polygon id="laser1" points="0,0 160,210" style="stroke:rgb(255,0,0);stroke-width:2" />
    <line id="laser2" x1="271" y1="345" x2="0" y2="0" style="stroke:rgb(255,0,0);stroke-width:2" />

    <use href="#fast-mountains-item" transform="translate(-100 50)"/>


    <script>
      var canvas = document.getElementById('canvas');
      var up=true;
      setInterval(() => {
        // document.getElementById('laser1').setAttribute('points', up?'271,340 ':'271,320 ' + dx + ',' + dy );
        // document.getElementById('laser2').setAttribute('y', up?300:320);


        var graphAnimation = document.getElementById('superman').getElementsByTagName('animate')[0];
        graphAnimation.setAttribute('to', up?300:320);
        graphAnimation.setAttribute('from', up?320:300);
        graphAnimation.beginElement();

        console.log(up + ' ' + document.getElementById('superman').getAttribute('y'));
        up = !up;
      },500);

      function mouseMove(evt){
        let mousePosition = cursorPoint(evt);
        mousePosition.x = Math.round(mousePosition.x);
        mousePosition.y = Math.round(mousePosition.y);

        document.getElementById('posX').textContent = 'X: ' + mousePosition.x + 'px ';
        document.getElementById('posY').textContent = 'Y: ' + mousePosition.y + 'px';

        document.getElementById('laser1').setAttribute( 'points','271,340 ' + mousePosition.x + ',' + mousePosition.y );
        document.getElementById('laser2').setAttribute( 'x2',mousePosition.x);
        document.getElementById('laser2').setAttribute( 'y2',mousePosition.y);
      }
      var pt = canvas.createSVGPoint();
      function cursorPoint(evt){
        pt.x = evt.clientX; pt.y = evt.clientY;
        return pt.matrixTransform(canvas.getScreenCTM().inverse());
      }

      function revert(evt){
        document.getElementById('posX').textContent = 'X: -- px';
        document.getElementById('posY').textContent = 'Y: -- px';
      }
    </script>

</svg>